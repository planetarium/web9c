function N(){return typeof window<"u"&&typeof window.scrollY=="number"}function ye(){return!(typeof process>"u"||!process.cwd||!process.versions||typeof process.versions.node>"u"||!process.release||process.release.name!=="node")}function V(e,t){let n;{var s=Error.stackTraceLimit;Error.stackTraceLimit=1/0,n=new Error(e),Error.stackTraceLimit=s}return ye()&&(n.stack=ve(n.stack,t)),n}function ve(e,t){if(!e)return e;const n=be(e);let s=0;return n.filter(o=>o.includes(" (internal/")||o.includes(" (node:internal")?!1:s<t&&Ee(o)?(s++,!1):!0).join(`
`)}function Ee(e){return e.startsWith("    at ")}function be(e){return e.split(/\r?\n/)}function F(e,t){const n=globalThis.__vite_plugin_ssr=globalThis.__vite_plugin_ssr||{};return n[e]=n[e]||t}function z(e){return Array.from(new Set(e))}const E=F("assertPackageInstances.ts",{instances:[],alreadyLogged:new Set}),ne="Make sure your client-side code doesn't include(/bundle)",se=`The client runtime of Server Routing and the client runtime of Client Routing are both being loaded. ${ne} both for a given page.`,B=`Two vite-plugin-ssr client runtime instances are being loaded. ${ne} vite-plugin-ssr twice. (In order to reduce the size of your client-side JavaScript bundles.)`;function M(){{const e=z(E.instances);if(e.length>1){const t=`Both vite-plugin-ssr@${e[0]} and vite-plugin-ssr@${e[1]} loaded. Only one version should be loaded.`;Re(!1,t)}}E.checkSingleInstance&&E.instances.length>1&&T(!1,B,{onlyOnce:!0,showStackTrace:!0})}function At(e){T(E.isClientRouting!==!0,se,{onlyOnce:!0,showStackTrace:!0}),T(E.isClientRouting===void 0,B,{onlyOnce:!0,showStackTrace:!0}),E.isClientRouting=!1,e&&(E.checkSingleInstance=!0),M()}function Dt(e){T(E.isClientRouting!==!1,se,{onlyOnce:!0,showStackTrace:!0}),T(E.isClientRouting===void 0,B,{onlyOnce:!0,showStackTrace:!0}),E.isClientRouting=!0,e&&(E.checkSingleInstance=!0),M()}function $e(e){E.instances.push(e),M()}function Re(e,t){if(e)return;const n=`[vite-plugin-ssr][Wrong Usage] ${t}`;throw new Error(n)}function T(e,t,{onlyOnce:n,showStackTrace:s}){if(e)return;const i=`[vite-plugin-ssr][Warning] ${t}`;if(n){const{alreadyLogged:o}=E,a=n===!0?i:n;if(o.has(a))return;o.add(a)}console.warn(s?new Error(i):i)}const we="0.4.131",_={projectName:"vite-plugin-ssr",projectVersion:we,npmPackageName:"vite-plugin-ssr",githubRepository:"https://github.com/brillout/vite-plugin-ssr"};$e(_.projectVersion);const $=F("assert.ts",{alreadyLogged:new Set}),P=`[${_.npmPackageName}@${_.projectVersion}]`,_e=`${P}[Bug]`,Se=`${P}[Wrong Usage]`,Pe=`${P}[Warning]`,Te=`${P}[Info]`,U=2;function r(e,t){var n;if(e)return;const s=(()=>{if(!t)return null;const o=typeof t=="string"?t:"`"+JSON.stringify(t)+"`";return`Debug info (this is for the ${_.projectName} maintainers; you can ignore this): ${o}`})(),i=V([`${_e} You stumbled upon a bug in ${_.projectName}'s source code.`,`Go to ${_.githubRepository}/issues/new and copy-paste this error. (The error's stack trace is usually enough to fix the problem).`,"A maintainer will fix the bug (usually under 24 hours).",`Don't hesitate to reach out as it makes ${_.projectName} more robust.`,s].filter(Boolean).join(" "),U);throw(n=$.onBeforeLog)===null||n===void 0||n.call($),i}function y(e,t){var n;if(e)return;const s=t.startsWith("[")?"":" ",i=`${Se}${s}${t}`,o=V(i,U);throw(n=$.onBeforeLog)===null||n===void 0||n.call($),o}function Ie(e){const t=e.startsWith("[")?"":" ";return V(`${P}${t}${e}`,U)}function I(e,t,{onlyOnce:n=!0,showStackTrace:s=!1}={}){var i;if(e)return;const o=`${Pe} ${t}`;if(n){const{alreadyLogged:a}=$,l=n===!0?o:n;if(a.has(l))return;a.add(l)}(i=$.onBeforeLog)===null||i===void 0||i.call($),console.warn(s?new Error(o):o)}function Nt(e,t,{onlyOnce:n}){var s;if(e)return;const i=`${Te} ${t}`;if(n){const{alreadyLogged:o}=$,a=i;if(o.has(a))return;o.add(a)}(s=$.onBeforeLog)===null||s===void 0||s.call($),console.log(i)}const L=F("utils/assertRouterType.ts",{});function Vt(){ie(Fe()),L.isClientRouting=!0}function Fe(){return L.isClientRouting!==!1}function zt(){ie(L.isClientRouting!==!0),L.isClientRouting=!1}function ie(e){y(N(),"`import { something } from 'vite-plugin-ssr/client/router'` is forbidden on the server-side"),I(e,"You shouldn't `import { something } from 'vite-plugin-ssr/client/router'` when using Server Routing. The 'vite-plugin-ssr/client/router' utilities work only with Client Routing. In particular, don't `import { navigate }` nor `import { prefetch }` when using Server Routing as these will unnecessarily bloat your client-side bundle.",{showStackTrace:!1,onlyOnce:!0})}function Y(e){const t=e/1e3;if(t<120){const n=q(t);return`${n} second${K(n)}`}{const n=t/60,s=q(n);return`${s} minute${K(s)}`}}function q(e){let t=e.toFixed(1);return t.endsWith(".0")&&(t=t.slice(0,-2)),t}function K(e){return e==="1"?"":"s"}function je(e,t,n){const{timeoutErr:s,timeoutWarn:i}=Le(t);let o,a;const l=new Promise((d,p)=>{o=h=>{c(),d(h)},a=h=>{c(),p(h)}}),c=()=>{clearTimeout(u),clearTimeout(g)},u=setTimeout(()=>{const d=`${P}[Warning] The ${t}() hook defined by ${n} is taking more than ${Y(i)}`;console.warn(d)},i),g=setTimeout(()=>{const d=Ie(`Hook timeout: the ${t}() hook defined by ${n} didn't finish after ${Y(s)}`);a(d)},s);return(async()=>{try{const d=await e();o(d)}catch(d){a(d)}})(),l}function Le(e){let t=4e4,n=4*1e3;return e==="onBeforeRoute"&&(t=5*1e3,n=1*1e3),e==="onBeforePrerender"&&(t=10*60*1e3,n=30*1e3),{timeoutErr:t,timeoutWarn:n}}function O(e,t,n){return typeof e=="string"?Q(e.split(""),t,n).join(""):Q(e,t,n)}function Q(e,t,n){const s=[];let i=t>=0?t:e.length+t;r(i>=0&&i<=e.length);let o=n>=0?n:e.length+n;for(r(o>=0&&o<=e.length);!(i===o||(i===e.length&&(i=0),i===o));){const a=e[i];r(a!==void 0),s.push(a),i++}return s}function re(e){return e.startsWith("/")||e.startsWith("http")||e.startsWith("tauri://")||e.startsWith(".")||e.startsWith("?")||e.startsWith("#")||e===""}function Bt(e,t){r(t.includes(" but ")),y(typeof e=="string",`${t} should be a string`),!re(e)&&(!e.startsWith("/")&&!e.includes(":")?y(!1,`${t} is '${e}' and it should be '/${e}' instead (URL pathnames should start with a leading slash)`):y(!1,`${t} isn't a valid URL`))}function Oe(e,t){r(re(e),{url:e}),r(t.startsWith("/"),{url:e,baseServer:t});const[n,...s]=e.split("#");r(n!==void 0);const i=["",...s].join("#")||null;r(i===null||i.startsWith("#"));const o=i===null?"":C(i.slice(1)),[a,...l]=n.split("?");r(a!==void 0);const c=["",...l].join("?")||null;r(c===null||c.startsWith("?"),{url:e,searchOriginal:c});const u={},g={};Array.from(new URLSearchParams(c||"")).forEach(([v,J])=>{u[v]=J,g[v]=[...g[v]||[],J]});const{origin:d,pathnameResolved:p}=We(a,t);r(d===null||d===C(d),{origin:d}),r(p.startsWith("/"),{url:e,pathnameResolved:p}),r(d===null||e.startsWith(d),{url:e,origin:d});const h=a.slice((d||"").length);{const v=`${d||""}${h}${c||""}${i||""}`;r(e===v,{url:e,urlRecreated:v})}let{pathname:m,hasBaseServer:R}=Ce(p,t);return m=ke(m),r(m.startsWith("/")),{origin:d,pathname:m,pathnameOriginal:h,hasBaseServer:R,search:u,searchAll:g,searchOriginal:c,hash:o,hashOriginal:i}}function C(e){try{return decodeURIComponent(e)}catch{}try{return decodeURI(e)}catch{}return e}function ke(e){return e.split("/").map(t=>C(t).split("/").join("%2F")).join("/")}function We(e,t){var n;if(e.startsWith("//"))return{origin:null,pathnameResolved:e};let s=!1;const i="tauri://",o="http://";e.startsWith(i)&&(s=!0,e=o+e.slice(i.length));let a,l;try{const c=new URL(e);a=c.origin,l=c.pathname}catch{a=null;let u=typeof window<"u"&&((n=window==null?void 0:window.document)===null||n===void 0?void 0:n.baseURI);u=u||"http://fake.example.org"+t,l=new URL(e,u).pathname}return l||(l="/"),s&&(r(a),r(a.startsWith(o)),a=i+a.slice(o.length)),r(l.startsWith("/"),{urlWithoutSearch:e,pathnameResolved:l}),r(l===l.split("?")[0].split("#")[0]),{origin:a,pathnameResolved:l}}function xe(e){r(e.startsWith("/")),r(!e.includes("?")),r(!e.includes("#"))}function Ce(e,t){xe(e),r(Ae(t));let n=e;if(r(n.startsWith("/")),r(t.startsWith("/")),t==="/")return{pathname:e,hasBaseServer:!0};let s=t;return t.endsWith("/")&&n===O(t,0,-1)&&(s=O(t,0,-1),r(n===s)),n.startsWith(s)?(r(n.startsWith("/")||n.startsWith("http")),r(n.startsWith(s)),n=n.slice(s.length),n.startsWith("/")||(n="/"+n),r(n.startsWith("/")),{pathname:n,hasBaseServer:!0}):{pathname:e,hasBaseServer:!1}}function Ae(e){return e.startsWith("/")}function Mt(e){const t=window.location.href,{searchOriginal:n,hashOriginal:s,pathname:i}=Oe(t,"/");let o;return e!=null&&e.withoutHash?o=`${i}${n||""}`:o=`${i}${n||""}${s||""}`,r(o.startsWith("/")),o}function k(e){return e instanceof Function||typeof e=="function"}function b(e){return typeof e=="object"&&e!==null}function f(e,t,n="unknown"){if(!b(e))return!1;if(!(t in e))return n==="undefined";if(n==="unknown")return!0;const s=e[t];return n==="array"?Array.isArray(s):n==="object"?b(s):n==="string[]"?Array.isArray(s)&&s.every(i=>typeof i=="string"):n==="function"?k(s):Array.isArray(n)?typeof s=="string"&&n.includes(s):n==="null"?s===null:n==="undefined"?s===void 0:n==="true"?s===!0:n==="false"?s===!1:typeof s===n}function H(e,t){Object.assign(e,t)}r(N());const De=["js","ts","cjs","cts","mjs","mts","jsx","tsx","cjsx","ctsx","mjsx","mtsx"],oe=["vue","svelte","marko","md","mdx"],Ne=[...De,...oe];function ae(e){const t=Ne.some(n=>e.endsWith("."+n));return r(!Ve(e)||t),t}function Ve(e){return/\.(c|m)?(j|t)sx?$/.test(e)}function ze(e){return oe.some(t=>e.endsWith("."+t))}function Ut(e){return(t,n)=>{const s=e(t),i=e(n);return s===i?0:s>i?-1:1}}function Be(e){return(t,n)=>{const s=e(t),i=e(n);if(r([!0,!1,null].includes(s)),r([!0,!1,null].includes(i)),s===i)return 0;if(s===!0||i===!1)return-1;if(i===!0||s===!1)return 1;r(!1)}}function Me(e){return Be(t=>{const n=e(t);return n===null?null:!n})}function Ue(e,t){return e.toLowerCase()<t.toLowerCase()?-1:e.toLowerCase()>t.toLowerCase()?1:0}const He=e=>e!=null,Ge="\\";function le(e){const t=n=>`Not a posix path: ${n}`;r(e!==null,t("null")),r(typeof e=="string",t(`typeof path === '${typeof e}'`)),r(e!=="",t("(empty string)")),r(e),r(!e.includes(Ge),t(e))}const X=/[^a-zA-Z-_]/;function ce(e){return Je(e)!==null}function Je(e){if(e===void 0||e.includes("\\")||e.startsWith("/"))return null;let t=null;if(e.startsWith("@")){if(!e.includes("/"))return null;const[l,...c]=e.split("/");t=l,e=c.join("/"),r(t&&t.startsWith("@"))}if(e==="")return null;const[n,...s]=e.split("/"),i=n,o=s.length===0?null:s.join("/");return r(i),r(o===null||!o.startsWith("/")),X.test(i)||t&&X.test(t.slice(1))?null:(r(!i.startsWith("/")),{npmPackageName:t?`${t}/${i}`:i,importPath:o})}const Ye=["$$registrations","_rerender_only"],qe=[".md",".mdx"];function Ke(e,t){Qe(e,t,!0)}function Qe(e,t,n){const i=Object.keys(e).filter(l=>!Ye.includes(l)),o=i.filter(l=>l!=="default"),a=i.includes("default");if(o.length===0){if(a)return;r(i.length===0),y(!1,`${t} doesn't export any value, but it should have a \`export default\` instead`)}else if(!qe.some(l=>t.endsWith(l))){const l=o.join(", ");n?I(o.length===0,`${t} should only have a default export: remove \`export { ${l} }\``,{onlyOnce:!0,showStackTrace:!1}):I(o.length===0,`${t} replace \`export { ${l} }\` with \`export default { ${l} }\``,{onlyOnce:!0,showStackTrace:!1})}}function Xe(e){return Object.entries(e)}const Ze=["clientRouting"];function et(e){Ze.forEach(t=>{if(r(e.fileExports),!(t in e.fileExports))return;const n=`The value of \`${t}\` is only allowed to be \`true\`.`;y(e.fileExports[t]!==!1,`${e.filePath} has \`export { ${t} }\` with the value \`false\` which is prohibited: remove \`export { ${t} }\` instead. (${n})`),y(e.fileExports[t]===!0,`${e.filePath} has \`export { ${t} }\` with a forbidden value. ${n}`)})}const ue=["render","clientRouting","prerender","doNotPrerender"];function tt(e,t){y(!ue.includes(e),`${t} has \`export default { ${e} }\` which is prohibited, use \`export { ${e} }\` instead.`)}function nt(e,t){const n={},s={},i={};if(e.forEach(l=>{st(l).forEach(({exportName:u,exportValue:g,isFromDefaultExport:d})=>{var p;r(u!=="default"),i[u]=(p=i[u])!==null&&p!==void 0?p:[],i[u].push({exportValue:g,exportSource:`${l.filePath} > ${d?`\`export default { ${u} }\``:`\`export { ${u} }\``}`,filePath:l.filePath,_filePath:l.filePath,_fileType:l.fileType,_isFromDefaultExport:d})})}),t){const{configValues:l}=t;Xe(l).forEach(([c,u])=>{var g,d,p;const h=t.configElements[c];r(h);const{configDefinedByFile:m,configDefinedAt:R}=h;r(m),s[c]=(g=s[c])!==null&&g!==void 0?g:u,n[c]=(d=n[c])!==null&&d!==void 0?d:[],r(n[c].length===0),n[c].push({configValue:u,configDefinedAt:R,configDefinedByFile:m});const v=c;i[v]=(p=i[v])!==null&&p!==void 0?p:[],i[v].push({exportValue:u,exportSource:R,filePath:m,_filePath:m,_fileType:null,_isFromDefaultExport:null})})}const o=it(),a={};return Object.entries(i).forEach(([l,c])=>{c.forEach(({exportValue:u,_fileType:g,_isFromDefaultExport:d})=>{var p;a[l]=(p=a[l])!==null&&p!==void 0?p:u,g===".page"&&!d&&(l in o||(o[l]=u))})}),r(!("default"in a)),r(!("default"in i)),{config:s,configEntries:n,exports:a,exportsAll:i,pageExports:o}}function st(e){const{filePath:t,fileExports:n}=e;r(n),r(ae(t));const s=[];return Object.entries(n).sort(Me(([i])=>i==="default")).forEach(([i,o])=>{let a=i==="default";if(a)if(ze(t))i="Page";else{y(b(o),`The \`export default\` of ${t} should be an object.`),Object.entries(o).forEach(([l,c])=>{tt(l,t),s.push({exportName:l,exportValue:c,isFromDefaultExport:a})});return}s.push({exportName:i,exportValue:o,isFromDefaultExport:a})}),s.forEach(({exportName:i,isFromDefaultExport:o})=>{r(!(o&&ue.includes(i)))}),s}function it(){return new Proxy({},{get(...e){return N()||I(!1,"`pageContext.pageExports` is outdated. Use `pageContext.exports` instead, see https://vite-plugin-ssr.com/exports",{onlyOnce:!0,showStackTrace:!0}),Reflect.get(...e)}})}function rt(e){const t=".page.",n=O(e.split(t),0,-1).join(t);return r(!n.includes("\\")),n}function S(e){le(e),r(e.startsWith("/")||ce(e),{filePath:e})}function Ht(e,t){if(t.length>0){const s=t.filter(i=>i.isErrorPage);return s.length===0?null:(y(s.length===1,"Only one error page can be defined"),s[0].pageId)}const n=z(e.map(({pageId:s})=>s).filter(s=>W(s)));if(y(n.length<=1,`Only one _error.page.js is allowed, but found several: ${n.join(" ")}`),n.length>0){const s=n[0];return r(s),s}return null}function W(e,t){return r(!e.includes("\\")),e.includes("/_error")}function ot(e,t){if(t.length>0){const n=t.find(s=>s.pageId===e);return r(n),n.isErrorPage}else return W(e)}const at=[".page",".page.server",".page.route",".page.client",".css"];function lt(e){if(le(e),e.endsWith(".css"))return r(ce(e),e),".css";r(ae(e),e);const n=e.split("/").slice(-1)[0].split("."),s=n.slice(-3)[0],i=n.slice(-2)[0];if(i==="page")return".page";if(r(s==="page",e),i==="server")return".page.server";if(i==="client")return".page.client";if(i==="route")return".page.route";r(!1,e)}function fe(e){const t=o=>i.pageId===o||i.isDefaultPageFile&&(Z(i.filePath)||ct(o,i.filePath)),n=lt(e),i={filePath:e,fileType:n,isEnv:o=>{if(r(n!==".page.route"),o==="CLIENT_ONLY")return n===".page.client"||n===".css";if(o==="SERVER_ONLY")return n===".page.server";if(o==="CLIENT_AND_SERVER")return n===".page";r(!1)},isRelevant:t,isDefaultPageFile:A(e),isRendererPageFile:n!==".css"&&A(e)&&Z(e),isErrorPageFile:W(e),pageId:rt(e)};return i}function A(e){return S(e),W(e)?!1:e.includes("/_default")}function Z(e){return S(e),e.includes("/renderer/")}function ct(e,t){S(e),S(t),r(!e.endsWith("/")),r(!t.endsWith("/")),r(A(t));const n=O(t.split("/"),0,-1).filter(s=>s!=="_default").join("/");return e.startsWith(n)}function ut(e){r(Array.isArray(e)||e===null),r(e!==null),e.forEach(t=>{r(b(t)),r(f(t,"pageId","string")),r(f(t,"routeFilesystem","string")||f(t,"routeFilesystem","null")),r(f(t,"routeFilesystemDefinedBy","string")||f(t,"routeFilesystemDefinedBy","null")),r(f(t,"loadCodeFiles","function")),r(f(t,"isErrorPage","boolean")),r(f(t,"configElements","object")),de(t.configElements,!1)})}function ft(e){de(e,!0)}function de(e,t){r(b(e)),Object.entries(e).forEach(([n,s])=>{if(r(b(s)||s===null),s===null){r(t);return}r(f(s,"configDefinedAt","string")),r(f(s,"plusConfigFilePath","string")||f(s,"plusConfigFilePath","null")),r(f(s,"configEnv","string")),r(f(s,"codeFilePath","string")||f(s,"codeFilePath","null")),r(f(s,"codeFileExport","string")||f(s,"codeFileExport","null")),r(f(s,"configValueSerialized","string")||f(s,"configValueSerialized","undefined")),(t||n==="route")&&r(f(s,"configValue")||f(s,"configValueSerialized"))})}const dt=[{is:e=>e===void 0,match:e=>e==="!undefined",serialize:()=>"!undefined",deserialize:()=>{}},{is:e=>e===1/0,match:e=>e==="!Infinity",serialize:()=>"!Infinity",deserialize:()=>1/0},{is:e=>e===-1/0,match:e=>e==="!-Infinity",serialize:()=>"!-Infinity",deserialize:()=>-1/0},{is:e=>typeof e=="number"&&isNaN(e),match:e=>e==="!NaN",serialize:()=>"!NaN",deserialize:()=>NaN},{is:e=>e instanceof Date,match:e=>e.startsWith("!Date:"),serialize:e=>"!Date:"+e.toISOString(),deserialize:e=>new Date(e.slice(6))},{is:e=>typeof e=="bigint",match:e=>e.startsWith("!BigInt:"),serialize:e=>"!BigInt:"+e.toString(),deserialize:e=>{if(typeof BigInt>"u")throw new Error("Your JavaScript environement does not support BigInt. Consider adding a polyfill.");return BigInt(e.slice(8))}},{is:e=>e instanceof RegExp,match:e=>e.startsWith("!RegExp:"),serialize:e=>"!RegExp:"+e.toString(),deserialize:e=>{e=e.slice(8);const t=e.match(/\/(.*)\/(.*)?/),n=t[1],s=t[2];return new RegExp(n,s)}},{is:e=>e instanceof Map,match:e=>e.startsWith("!Map:"),serialize:(e,t)=>"!Map:"+t(Array.from(e.entries())),deserialize:(e,t)=>new Map(t(e.slice(5)))},{is:e=>e instanceof Set,match:e=>e.startsWith("!Set:"),serialize:(e,t)=>"!Set:"+t(Array.from(e.values())),deserialize:(e,t)=>new Set(t(e.slice(5)))},{is:e=>typeof e=="string"&&e.startsWith("!"),match:e=>e.startsWith("!"),serialize:e=>"!"+e,deserialize:e=>e.slice(1)}];function G(e){const t=JSON.parse(e);return ge(t)}function ge(e){return typeof e=="string"?gt(e):(typeof e=="object"&&e!==null&&Object.entries(e).forEach(([t,n])=>{e[t]=ge(n)}),e)}function gt(e){for(const{match:t,deserialize:n}of dt)if(t(e))return n(e,G);return e}function ht(e){e.forEach(t=>{Object.entries(t.configElements).forEach(([n,s])=>{pt(s),n==="route"&&mt(s)})})}function pt(e){const{configValueSerialized:t}=e;t!==void 0&&(e.configValue=G(t))}function mt(e){r(f(e,"configValue"));const{configValue:t}=e,n=typeof t;y(n==="string"||k(t),`${e.configDefinedAt} has an invalid type '${n}': it should be a string or a function instead, see https://vite-plugin-ssr.com/route`)}function yt(e){r(f(e,"isGeneratedFile")),r(e.isGeneratedFile!==!1,"vite-plugin-ssr was re-installed(/re-built). Restart your app."),r(e.isGeneratedFile===!0,`\`isGeneratedFile === ${e.isGeneratedFile}\``),r(f(e,"pageFilesLazy","object")),r(f(e,"pageFilesEager","object")),r(f(e,"pageFilesExportNamesLazy","object")),r(f(e,"pageFilesExportNamesEager","object")),r(f(e.pageFilesLazy,".page")),r(f(e.pageFilesLazy,".page.client")||f(e.pageFilesLazy,".page.server")),r(f(e,"pageFilesList","string[]")),r(f(e,"pageConfigs")),r(f(e,"pageConfigGlobal"));const{pageConfigs:t,pageConfigGlobal:n}=e;ut(t),ht(t),ft(n);const s={};j(e.pageFilesLazy).forEach(({filePath:o,pageFile:a,globValue:l})=>{var c;a=s[o]=(c=s[o])!==null&&c!==void 0?c:a;const u=l;ee(u),a.loadFile=async()=>{"fileExports"in a||(a.fileExports=await u(),et(a))}}),j(e.pageFilesExportNamesLazy).forEach(({filePath:o,pageFile:a,globValue:l})=>{var c;a=s[o]=(c=s[o])!==null&&c!==void 0?c:a;const u=l;ee(u),a.loadExportNames=async()=>{if(!("exportNames"in a)){const g=await u();y("exportNames"in g,"You seem to be using Vite 2 but the latest vite-plugin-ssr versions only work with Vite 3"),r(f(g,"exportNames","string[]"),a.filePath),a.exportNames=g.exportNames}}}),j(e.pageFilesEager).forEach(({filePath:o,pageFile:a,globValue:l})=>{var c;a=s[o]=(c=s[o])!==null&&c!==void 0?c:a;const u=l;r(b(u)),a.fileExports=u}),j(e.pageFilesExportNamesEager).forEach(({filePath:o,pageFile:a,globValue:l})=>{var c;a=s[o]=(c=s[o])!==null&&c!==void 0?c:a;const u=l;r(b(u)),r(f(u,"exportNames","string[]"),a.filePath),a.exportNames=u.exportNames}),e.pageFilesList.forEach(o=>{var a;s[o]=(a=s[o])!==null&&a!==void 0?a:fe(o)});const i=Object.values(s);return i.forEach(({filePath:o})=>{r(!o.includes("\\"))}),{pageFiles:i,pageConfigs:t,pageConfigGlobal:n}}function j(e){const t=[];return Object.entries(e).forEach(([n,s])=>{r(at.includes(n)),r(b(s)),Object.entries(s).forEach(([i,o])=>{const a=fe(i);r(a.fileType===n),t.push({filePath:i,pageFile:a,globValue:o})})}),t}function ee(e){r(k(e))}const w=F("setPageFiles.ts",{});function Gt(e){const{pageFiles:t,pageConfigs:n,pageConfigGlobal:s}=yt(e);w.pageFilesAll=t,w.pageConfigs=n,w.pageConfigGlobal=s}async function Jt(e,t){e?(r(!w.pageFilesGetter),r(t===void 0)):(r(w.pageFilesGetter),r(typeof t=="boolean"),(!w.pageFilesAll||!t)&&await w.pageFilesGetter());const{pageFilesAll:n,pageConfigs:s,pageConfigGlobal:i}=w;r(n&&s&&i);const o=vt(n,s);return{pageFilesAll:n,allPageIds:o,pageConfigs:s,pageConfigGlobal:i}}function vt(e,t){const n=e.filter(({isDefaultPageFile:o})=>!o).map(({pageId:o})=>o),s=z(n),i=t.map(o=>o.pageId);return[...s,...i]}function Et(e,t){return he(e,t,!0)}function Yt(e,t){return he(e,t,!1)}function he(e,t,n){const s=n?"CLIENT_ONLY":"SERVER_ONLY",i=e.filter(h=>h.isRelevant(t)&&h.fileType!==".page.route").sort(bt(n,t)),o=h=>{const m=i.filter(v=>v.pageId===t&&v.isEnv(h?"CLIENT_AND_SERVER":s));y(m.length<=1,`Merge the following files into a single file: ${m.map(v=>v.filePath).join(" ")}`);const R=m[0];return r(R===void 0||!R.isDefaultPageFile),R},a=o(!1),l=o(!0),c=h=>i.filter(m=>m.isRendererPageFile&&m.isEnv(h?"CLIENT_AND_SERVER":s))[0],u=c(!1),g=c(!0),d=i.filter(h=>h.isDefaultPageFile&&!h.isRendererPageFile&&(h.isEnv(s)||h.isEnv("CLIENT_AND_SERVER")));return[a,l,...d,u,g].filter(He)}function bt(e,t){const n=e?"CLIENT_ONLY":"SERVER_ONLY",s=-1,i=1,o=0;return(a,l)=>{if(!a.isDefaultPageFile&&l.isDefaultPageFile)return s;if(!l.isDefaultPageFile&&a.isDefaultPageFile)return i;{const c=a.isRendererPageFile,u=l.isRendererPageFile;if(!c&&u)return s;if(!u&&c)return i;r(c===u)}{const c=te(t,a.filePath),u=te(t,l.filePath);if(c<u)return s;if(u<c)return i;r(c===u)}{if(a.isEnv(n)&&l.isEnv("CLIENT_AND_SERVER"))return s;if(l.isEnv(n)&&a.isEnv("CLIENT_AND_SERVER"))return i}return o}}function te(e,t){S(e),S(t);let n=0;for(;n<e.length&&n<t.length&&e[n]===t[n];n++);const s=e.slice(n),i=t.slice(n),o=s.split("/").length,a=i.split("/").length;return o+a}function $t(e,t){var n;const s=e.filter(o=>o.pageId===t);return r(s.length<=1),(n=s[0])!==null&&n!==void 0?n:null}async function Rt(e,t){const n={};return!t&&"configValues"in e||((await e.loadCodeFiles()).forEach(i=>{const{configName:o,codeFilePath:a}=i;let l;if(i.isPlusFile){const{codeFileExports:c}=i;o!=="client"&&Ke(c,a),Object.entries(c).forEach(([u,g])=>{const d=u!=="default",p=d?u:i.configName,h=g;if(n[p]=h,d){const m=e.configElements[i.configName];r(m),e.configElements[p]={configValue:h,codeFileExport:u,codeFilePath:a,configDefinedByFile:a,configDefinedAt:`${a} > export { ${u} }`,configEnv:m.configEnv,plusConfigFilePath:null}}})}else l=i.codeFileExportValue,n[o]=l}),Object.entries(e.configElements).map(([i,o])=>{o.codeFilePath||(n[i]=o.configValue)}),H(e,{configValues:n})),e}const pe="__whileFetchingAssets";async function qt(e,t,n){const s=Et(e,n),i=$t(t,n);let o;try{o=(await Promise.all([i&&Rt(i,!1),...s.map(h=>{var m;return(m=h.loadFile)===null||m===void 0?void 0:m.call(h)})]))[0]}catch(p){throw wt(p)&&Object.assign(p,{[pe]:!0}),p}const{config:a,configEntries:l,exports:c,exportsAll:u,pageExports:g}=nt(s,o);return{config:a,configEntries:l,exports:c,exportsAll:u,pageExports:g,_pageFilesLoaded:s}}function Kt(e){return e?e[pe]===!0:!1}function wt(e){return e instanceof Error?["Failed to fetch dynamically imported module","error loading dynamically imported module","Importing a module script failed","error resolving module specifier","failed to resolve module"].some(n=>e.message.toLowerCase().includes(n.toLowerCase())):!1}function Qt(e,t,n){const s=e.configElements[t];if(!s||me(e,t))return null;const{configValue:i,configDefinedAt:o}=s;return y(typeof i===n,`${o} has an invalid type \`${typeof i}\`: is should be a ${n} instead`),i}function Xt(e,t){const n=e.configElements[t];if(!n||me(e,t))return null;if(n.codeFilePath!==null)return n.codeFilePath;const{configValue:s,configDefinedAt:i}=n;y(typeof s=="string",`${i} has an invalid type \`${typeof s}\`: it should be a \`string\` instead`),y(!1,`${i} has an invalid value \`${s}\`: it should be a file path instead`)}function me(e,t){const n=e.configElements[t];if(!n)return!0;const{codeFilePath:s,configValue:i}=n;return s?!1:i==null}function _t(e,t){const n=t.find(s=>s.pageId===e);return r(t.length>0),r(n),n}function Zt(){const e="vite-plugin-ssr_pageContext",t=document.getElementById(e);y(t,`The element #${e} (which vite-plugin-ssr automatically injects into the HTML) is missing from the DOM. This may happen if your HTML is malformed. Make sure your HTML isn't malformed, and make sure you don't remove #${e} from the HTML nor from the DOM.`);const n=t.textContent;r(n);const s=G(n);r(f(s,"pageContext","object"));const{pageContext:i}=s;return r(f(i,"_pageId","string")),H(i,{_pageContextRetrievedFromServer:{...i},_comesDirectlyFromServer:!0}),i}function D(e,t){if(!(t in e.exports))return null;const n=e.exports[t],s=e.exportsAll[t][0];r(s.exportValue===n);const i=s.exportSource;return r(i),r(!t.endsWith(")")),y(k(n),`hook ${t}() defined by ${i} should be a function`),{hookFn:n,hookFilePath:i}}function en(e,t){D(e,t)}function St(e){const t=Object.entries(e);for(const n in e)delete e[n];t.sort(([n],[s])=>Ue(n,s)).forEach(([n,s])=>{e[n]=s})}function Pt(e){Tt(e),It(e)}function Tt(e){ot(e._pageId,e._pageConfigs)&&r(f(e,"is404","boolean"))}function It(e){if(e.is404===void 0||e.is404===null)return;const t=e.pageProps||{};if(!b(t)){I(!1,"pageContext.pageProps should be an object",{showStackTrace:!0,onlyOnce:!0});return}t.is404=t.is404||e.is404,e.pageProps=t}const x=F("releasePageContext.ts",{});function Ft(e,t){if(t){const i=e;r([!0,!1].includes(i.isHydration)),r([!0,!1,null].includes(i.isBackwardNavigation))}else{const i=e;r(i.isHydration===!0),r(i.isBackwardNavigation===null)}r("config"in e),r("configEntries"in e),r("exports"in e),r("exportsAll"in e),r("pageExports"in e),r(b(e.pageExports));const n=e.exports.Page;H(e,{Page:n}),Wt(e),St(e),r([!0,!1].includes(e._comesDirectlyFromServer));const s=e._comesDirectlyFromServer?Ot(e):e;return Pt(e),s}const jt=["then","toJSON"],Lt=["_pageId"];function Ot(e){return new Proxy(e,{get:n});function t(s){return!(s in e||jt.includes(s)||typeof s=="symbol"||typeof s!="string"||s.startsWith("__v_"))}function n(s,i){return x.disableAssertPassToClient!==i&&kt(e._pageContextRetrievedFromServer,i,t(i)),x.disableAssertPassToClient=i,window.setTimeout(()=>{x.disableAssertPassToClient=void 0},0),e[i]}}function kt(e,t,n){if(!n||e===null)return;const s=Object.keys(e).filter(i=>!Lt.includes(i));y(!1,[`pageContext.${t} isn't available in the browser`,`('${t}' is missing in the passToClient list [${s.map(i=>`'${i}'`).join(", ")}]).`,`Did you forget to add '${t}' to the passToClient list?`,"See https://vite-plugin-ssr.com/passToClient"].join(" "))}function Wt(e){Object.entries(e).forEach(([t,n])=>{delete e[t],e[t]=n})}async function tn(e,t){const n=Ft(e,t);let s=null,i;s=D(e,"render"),i="render";{const l=D(e,"onRenderClient");l&&(s=l,i="onRenderClient")}if(!s){const l=xt(e);if(e._pageConfigs.length>0)Ct(e._pageId,e._pageConfigs,l);else{const c=e._pageFilesLoaded.filter(g=>g.fileType===".page.client");let u;c.length===0?u="No file `*.page.client.*` found for URL "+l:u="One of the following files should export a `render()` hook: "+c.map(g=>g.filePath).join(" "),y(!1,u)}}r(s);const o=s.hookFn;r(i);const a=await je(()=>o(n),i,s.hookFilePath);y(a===void 0,`The ${i}() hook defined by ${s.hookFilePath} isn't allowed to return a value`)}function xt(e){let t;try{t=e.urlOriginal}catch{}return t=t??window.location.href,t}function Ct(e,t,n){var s,i;const o=_t(e,t);r(!(!((s=o.configElements.onRenderClient)===null||s===void 0)&&s.configValue)),r(((i=o.configElements.clientRouting)===null||i===void 0?void 0:i.configValue)===!0);let a=!1;t.forEach(l=>{const c=l.configElements.onRenderClient;c&&c.configValue&&(a=!0)}),y(!1,`No onRenderClient() hook defined${a?` for URL \`${n}\``:""}, but it's needed, see https://vite-plugin-ssr.com/onRenderClient`)}export{re as A,Nt as B,Mt as C,Zt as D,qt as E,Ht as F,D as G,Ft as H,je as I,_t as J,G as K,Ie as L,en as M,tn as N,Kt as O,zt as P,At as Q,Vt as a,r as b,y as c,Fe as d,k as e,O as f,F as g,Ut as h,N as i,W as j,f as k,I as l,Be as m,b as n,Dt as o,Oe as p,Bt as q,H as r,Gt as s,Jt as t,Ae as u,Et as v,Yt as w,Qt as x,Xt as y,$t as z};
